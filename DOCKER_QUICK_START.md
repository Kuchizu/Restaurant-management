# ğŸš€ ULTRA-FAST Docker Build Guide

## âš¡ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Ğ§Ñ‚Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾:
1. **âœ… 3-stage Multi-stage build** - Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ»Ğ¾ĞµĞ²
2. **âœ… BuildKit enabled** - Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ±Ğ¾Ñ€ĞºĞ¸
3. **âœ… Gradle cache mount** - ĞºÑÑˆ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ±Ğ¾Ñ€ĞºĞ°Ğ¼Ğ¸
4. **âœ… .dockerignore** - Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¾ 500MB+ Ğ½ĞµĞ½ÑƒĞ¶Ğ½Ñ‹Ñ… Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
5. **âœ… Parallel builds** - Ğ²ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ÑÑ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾
6. **âœ… Coverage disabled** - Ñ‚ĞµÑÑ‚Ñ‹ Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹ Ğ´Ğ»Ñ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸
7. **âœ… Optimized JVM settings** - Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ğ°Ñ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²

### Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
- **ĞŸĞµÑ€Ğ²Ğ°Ñ ÑĞ±Ğ¾Ñ€ĞºĞ°**: ~3-5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ (ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹)
- **ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ ÑĞ±Ğ¾Ñ€ĞºĞ¸**: ~30-60 ÑĞµĞºÑƒĞ½Ğ´ (ĞºÑÑˆ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚!)
- **Rebuild Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°**: ~10-20 ÑĞµĞºÑƒĞ½Ğ´

---

## ğŸ¯ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Windows:
```cmd
fast-build.bat
```

### Linux/Mac:
```bash
./fast-build.sh
```

---

## ğŸ”„ ĞŸĞµÑ€ĞµÑĞ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½ ÑĞµÑ€Ğ²Ğ¸Ñ

Ğ•ÑĞ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ´Ğ¸Ğ½ ÑĞµÑ€Ğ²Ğ¸Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, menu-service):

```bash
# Linux/Mac
./rebuild-service.sh menu-service

# Windows - Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
docker-compose up --build -d --no-deps menu-service
```

---

## ğŸ“Š ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ:
```bash
docker-compose ps
```

### ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸:
```bash
# Ğ’ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
docker-compose logs -f

# ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ
docker-compose logs -f menu-service
```

### ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ±ĞµĞ· Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¸:
```bash
docker-compose restart menu-service
```

### ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ²ÑÑ‘:
```bash
# Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ‘Ğ”
docker-compose down

# Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ²ÑÑ‘ Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
docker-compose down -v
```

### ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Docker cache (ĞµÑĞ»Ğ¸ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ ÑĞ»Ğ¾Ğ¼Ğ°Ğ»Ğ¾ÑÑŒ):
```bash
docker system prune -a --volumes
```

---

## ğŸŒ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼

ĞŸĞ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° (~2-3 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹):
- **API Gateway**: http://localhost:49999
- **Eureka Dashboard**: http://localhost:8761
- **Config Server**: http://localhost:8888
- **Order Service**: http://localhost:8081
- **Kitchen Service**: http://localhost:8082
- **Menu Service**: http://localhost:8083 âš¡ **(WebFlux + JPA)**
- **Inventory Service**: http://localhost:8084
- **Billing Service**: http://localhost:8085

### Swagger UI:
- Order: http://localhost:8081/swagger-ui.html
- Kitchen: http://localhost:8082/swagger-ui.html
- Menu: http://localhost:8083/swagger-ui.html
- Inventory: http://localhost:8084/swagger-ui.html
- Billing: http://localhost:8085/swagger-ui.html

---

## ğŸ› Troubleshooting

### ĞÑˆĞ¸Ğ±ĞºĞ° TLS handshake?
âœ… **Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾!** Dockerfile Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ `GRADLE_OPTS="-Dhttps.protocols=TLSv1.2,TLSv1.3"`

### Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ´Ğ¾Ğ»Ğ³Ğ°Ñ?
âœ… **Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾!** Ğ’ĞºĞ»ÑÑ‡ĞµĞ½ BuildKit Ğ¸ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Coverage Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸?
âœ… **Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾!** Coverage verification Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½

### ĞŸĞ¾Ñ€Ñ‚Ñ‹ Ğ·Ğ°Ğ½ÑÑ‚Ñ‹?
```bash
# ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ
netstat -ano | findstr :8761

# Ğ£Ğ±Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ (Windows)
taskkill /PID <PID> /F
```

---

## ğŸ’¡ Pro Tips

1. **ĞĞµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ğ¹Ñ‚Ğµ `docker-compose build` Ğ±ĞµĞ· `--parallel`** - Ğ±ÑƒĞ´ĞµÑ‚ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ğ¾!
2. **Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ `rebuild-service.sh`** Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¸
3. **Ğ”ĞµÑ€Ğ¶Ğ¸Ñ‚Ğµ Docker Desktop running** Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ¹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
4. **BuildKit Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚** - Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ ÑĞ±Ğ¾Ñ€ĞºĞ¸ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğµ!
5. **ĞĞµ ÑƒĞ´Ğ°Ğ»ÑĞ¹Ñ‚Ğµ volumes** Ğ±ĞµĞ· Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ - Ñ‚Ğ°Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ‘Ğ”

---

## ğŸ“ˆ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²:
```bash
docker stats
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²:
```bash
curl http://localhost:8081/actuator/health
curl http://localhost:8082/actuator/health
curl http://localhost:8083/actuator/health
curl http://localhost:8084/actuator/health
curl http://localhost:8085/actuator/health
```

---

## ğŸ“ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API Gateway (49999)                 â”‚
â”‚         Routes to all services              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         â”‚
    v                         v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Eureka  â”‚            â”‚ Config       â”‚
â”‚ (8761)  â”‚            â”‚ Server(8888) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                â”‚              â”‚             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€vâ”€â”€â”€â”€â”€â”
         â”‚ Order (8081)â”‚  â”‚ Kitchen     â”‚ â”‚ Menu (8083) â”‚ â”‚Billing â”‚
         â”‚WebFlux+R2DBCâ”‚  â”‚(8082)WebMVCâ”‚ â”‚WebFlux+JPA  â”‚ â”‚ (8085) â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                â”‚              â”‚             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€vâ”€â”€â”€â”€â”€â”€â”
         â”‚ order-db    â”‚  â”‚ kitchen-db  â”‚ â”‚ menu-db   â”‚ â”‚ bill-db â”‚
         â”‚ (5432)      â”‚  â”‚ (5433)      â”‚ â”‚ (5434)    â”‚ â”‚ (5436)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Checklist Ğ¿ĞµÑ€ĞµĞ´ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼

- [ ] Docker Desktop Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½
- [ ] ĞŸĞ¾Ñ€Ñ‚Ñ‹ 5432-5436, 8761, 8888, 8081-8085, 49999 ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ñ‹
- [ ] Ğ•ÑÑ‚ÑŒ 4GB+ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾Ğ¹ RAM
- [ ] BuildKit Ğ²ĞºĞ»ÑÑ‡ĞµĞ½ (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ² ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°Ñ…)

**Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾! Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°Ğ¹Ñ‚Ğµ `fast-build.bat` Ğ¸Ğ»Ğ¸ `./fast-build.sh`** ğŸš€
